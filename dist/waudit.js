!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("lodash"),require("rxjs")):"function"==typeof define&&define.amd?define(["exports","lodash","rxjs"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).Waudit={},e.lodash,e.rxjs)}(this,(function(e,t,n){"use strict";class r{static getListeners(e,n){return t.filter(r.eventPool,n?{eventName:e,flag:n}:{eventName:e})}static on(e,t,n="default"){return r.eventPool.push({id:r.eventPool.length,eventName:e,handler:t,flag:n}),{id:r.eventPool.length-1,eventName:e,handler:t,flag:n}}static off(e,t){delete r.eventPool[t]}static clearAll(){r.eventPool=[]}static dispatch(e,t){n.from(r.getListeners(e)).subscribe(e=>{try{e.handler.apply(e,[t])}catch(n){this.onErrorCallback(e,t,n)}})}static onError(e){this.onErrorCallback=e}}r.eventPool=[],r.onErrorCallback=function(){};e.EventListener=r,e.ListenerCreator=class{constructor({flag:e="default"}){this.flag="",this.flag=e}onPageView(e){return r.on("page-view",e,this.flag)}onIndexView(e){return r.on("index-view",e,this.flag)}onChangeProfile(e){return r.on("change-profile",e,this.flag)}onKeywordSearch(e){return r.on("keyword-search",e,this.flag)}onCategoryView(e){return r.on("category-view",e,this.flag)}onProductView(e){return r.on("product-view",e,this.flag)}onAddToCart(e){return r.on("add-to-cart",e,this.flag)}onCartView(e){return r.on("cart-view",e,this.flag)}onCheckoutFinish(e){return r.on("checkout-finish",e,this.flag)}getEventListener(){return r}},Object.defineProperty(e,"__esModule",{value:!0})}));
